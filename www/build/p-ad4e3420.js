import{g as o,c as t}from"./p-d34b8ceb.js";import{OVERLAY_BACK_BUTTON_PRIORITY as n}from"./p-7261e130.js";let e=0;const s=new WeakMap,a=o=>({create:t=>l(o,t),dismiss:(t,n,e)=>f(document,t,n,o,e),getTop:async()=>y(document,o)}),i=a("ion-alert"),r=a("ion-action-sheet"),c=a("ion-picker"),u=a("ion-popover"),d=a("ion-toast"),p=o=>{const t=document;m(t);const n=e++;o.overlayIndex=n,o.hasAttribute("id")||(o.id="ion-overlay-"+n)},l=(o,t)=>customElements.whenDefined(o).then(()=>{const n=document,e=n.createElement(o);return e.classList.add("overlay-hidden"),Object.assign(e,t),b(n).appendChild(e),e.componentOnReady()}),m=o=>{0===e&&(e=1,o.addEventListener("focusin",t=>{const n=y(o);if(n&&n.backdropDismiss&&!x(n,t.target)){const o=n.querySelector("input,button");o&&o.focus()}}),o.addEventListener("ionBackButton",t=>{const e=y(o);e&&e.backdropDismiss&&t.detail.register(n,()=>e.dismiss(void 0,P))}),o.addEventListener("keyup",t=>{if("Escape"===t.key){const t=y(o);t&&t.backdropDismiss&&t.dismiss(void 0,P)}}))},f=(o,t,n,e,s)=>{const a=y(o,e,s);return a?a.dismiss(t,n):Promise.reject("overlay does not exist")},y=(o,t,n)=>{const e=((o,t)=>(void 0===t&&(t="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(o.querySelectorAll(t)).filter(o=>o.overlayIndex>0)))(o,t);return void 0===n?e[e.length-1]:e.find(o=>o.id===n)},v=async(n,e,s,a,i)=>{if(n.presented)return;n.presented=!0,n.willPresent.emit();const r=o(n),c=n.enterAnimation?n.enterAnimation:t.get(e,"ios"===r?s:a);await k(n,c,n.el,i)&&n.didPresent.emit()},h=async(n,e,a,i,r,c,u)=>{if(!n.presented)return!1;n.presented=!1;try{n.willDismiss.emit({data:e,role:a});const d=o(n),p=n.leaveAnimation?n.leaveAnimation:t.get(i,"ios"===d?r:c);"gesture"!==a&&await k(n,p,n.el,u),n.didDismiss.emit({data:e,role:a}),s.delete(n)}catch(d){console.error(d)}return n.el.remove(),!0},b=o=>o.querySelector("ion-app")||o.body,k=async(o,n,e,a)=>{e.classList.remove("overlay-hidden");const i=n(e.shadowRoot||o.el,a);o.animated&&t.getBoolean("animated",!0)||i.duration(0),o.keyboardClose&&i.beforeAddWrite(()=>{const o=e.ownerDocument.activeElement;o&&o.matches("input, ion-input, ion-textarea")&&o.blur()});const r=s.get(o)||[];return s.set(o,[...r,i]),await i.play(),!0},g=(o,t)=>{let n;const e=new Promise(o=>n=o);return w(o,t,o=>{n(o.detail)}),e},w=(o,t,n)=>{const e=s=>{o.removeEventListener(t,e),n(s)};o.addEventListener(t,e)},j=o=>"cancel"===o||o===P,x=(o,t)=>{for(;t;){if(t===o)return!0;t=t.parentElement}return!1},B=o=>o(),E=(o,n)=>{if("function"==typeof o)return t.get("_zoneGate",B)(()=>{try{return o(n)}catch(t){console.error(t)}})},P="backdrop";export{P as B,v as a,c as b,s as c,h as d,g as e,u as f,r as g,i as h,j as i,p,E as s,d as t}